/**
 * Global Modal Fix - Prevents Flickering and Stability Issues
 * ThinQShopping Platform
 * This file must be loaded AFTER Bootstrap CSS
 */

/* ============================================
   CRITICAL MODAL FIXES - HIGHEST PRIORITY
   ============================================ */

/* Reset and force stable modal positioning */
.modal {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    z-index: 1055 !important;
    display: none !important;
    width: 100% !important;
    height: 100% !important;
    overflow-x: hidden !important;
    overflow-y: auto !important;
    outline: 0 !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    background: transparent !important;
    
    /* Prevent flickering */
    -webkit-backface-visibility: hidden !important;
    backface-visibility: hidden !important;
    -webkit-perspective: 1000px !important;
    perspective: 1000px !important;
    will-change: opacity !important;
    transform: translateZ(0) !important;
    -webkit-transform: translateZ(0) !important;
    
    /* Disable animations that cause flickering */
    animation: none !important;
    -webkit-animation: none !important;
}

.modal.show {
    display: block !important;
}

/* Modal fade transition - simplified */
.modal.fade {
    transition: opacity 0.15s linear !important;
    opacity: 0;
}

.modal.fade.show {
    opacity: 1 !important;
}

.modal.fade .modal-dialog {
    transition: transform 0.3s ease-out !important;
    transform: translate(0, -50px) !important;
}

.modal.fade.show .modal-dialog {
    transform: translate(0, 0) !important;
}

/* Modal backdrop - critical fixes */
.modal-backdrop {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    z-index: 1050 !important;
    width: 100vw !important;
    height: 100vh !important;
    background-color: #000 !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    
    /* Prevent flickering */
    -webkit-backface-visibility: hidden !important;
    backface-visibility: hidden !important;
    will-change: opacity !important;
    transform: translateZ(0) !important;
    -webkit-transform: translateZ(0) !important;
    
    /* Disable animations */
    animation: none !important;
    -webkit-animation: none !important;
}

.modal-backdrop.fade {
    opacity: 0 !important;
    transition: opacity 0.15s linear !important;
}

.modal-backdrop.show {
    opacity: 0.5 !important;
}

/* Modal dialog - stable positioning */
.modal-dialog {
    position: relative !important;
    width: auto !important;
    margin: 1.75rem auto !important;
    max-width: 500px !important;
    pointer-events: none !important;
    
    /* Prevent flickering */
    transform: translateZ(0) !important;
    -webkit-transform: translateZ(0) !important;
    -webkit-backface-visibility: hidden !important;
    backface-visibility: hidden !important;
    
    /* Disable conflicting transitions */
    transition: transform 0.3s ease-out !important;
}

.modal-dialog-centered {
    display: flex !important;
    align-items: center !important;
    min-height: calc(100% - 3.5rem) !important;
}

.modal-dialog-scrollable {
    max-height: calc(100% - 3.5rem) !important;
}

.modal-dialog-scrollable .modal-content {
    max-height: calc(100vh - 3.5rem) !important;
    overflow: hidden !important;
}

.modal-dialog-scrollable .modal-body {
    overflow-y: auto !important;
}

/* Modal content */
.modal-content {
    position: relative !important;
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    pointer-events: auto !important;
    background-color: #fff !important;
    background-clip: padding-box !important;
    border: 1px solid rgba(0, 0, 0, 0.2) !important;
    border-radius: 0.3rem !important;
    outline: 0 !important;
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;
    
    /* Prevent flickering */
    transform: translateZ(0) !important;
    -webkit-transform: translateZ(0) !important;
    -webkit-backface-visibility: hidden !important;
    backface-visibility: hidden !important;
}

/* Modal header */
.modal-header {
    display: flex !important;
    flex-shrink: 0 !important;
    align-items: center !important;
    justify-content: space-between !important;
    padding: 1rem 1rem !important;
    border-bottom: 1px solid #dee2e6 !important;
    border-top-left-radius: calc(0.3rem - 1px) !important;
    border-top-right-radius: calc(0.3rem - 1px) !important;
}

.modal-title {
    margin-bottom: 0 !important;
    line-height: 1.5 !important;
}

/* Modal body */
.modal-body {
    position: relative !important;
    flex: 1 1 auto !important;
    padding: 1rem !important;
    overflow-y: auto !important;
}

/* Modal footer */
.modal-footer {
    display: flex !important;
    flex-wrap: wrap !important;
    flex-shrink: 0 !important;
    align-items: center !important;
    justify-content: flex-end !important;
    padding: 0.75rem !important;
    border-top: 1px solid #dee2e6 !important;
    border-bottom-right-radius: calc(0.3rem - 1px) !important;
    border-bottom-left-radius: calc(0.3rem - 1px) !important;
}

.modal-footer > * {
    margin: 0.25rem !important;
}

/* Close button */
.btn-close {
    box-sizing: content-box !important;
    width: 1em !important;
    height: 1em !important;
    padding: 0.25em 0.25em !important;
    color: #000 !important;
    background: transparent url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23000'%3e%3cpath d='M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z'/%3e%3c/svg%3e") center/1em auto no-repeat !important;
    border: 0 !important;
    border-radius: 0.25rem !important;
    opacity: 0.5 !important;
    cursor: pointer !important;
    z-index: 1056 !important;
    position: relative !important;
}

.btn-close:hover {
    color: #000 !important;
    text-decoration: none !important;
    opacity: 0.75 !important;
}

.btn-close:focus {
    outline: 0 !important;
    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25) !important;
    opacity: 1 !important;
}

/* Body scroll lock when modal is open */
body.modal-open {
    overflow: hidden !important;
    padding-right: 0 !important;
}

/* Prevent layout shifts */
.modal-open .admin-main-content,
.modal-open .user-main-content {
    overflow: hidden !important;
}

/* Fix for sidebar interference */
.modal-open .admin-sidebar,
.modal-open .user-sidebar {
    z-index: 1030 !important;
}

.modal-open .admin-header,
.modal-open .user-header {
    z-index: 1030 !important;
}

/* Hardware acceleration for all modal elements */
.modal,
.modal-dialog,
.modal-content,
.modal-backdrop {
    -webkit-transform: translate3d(0, 0, 0) !important;
    transform: translate3d(0, 0, 0) !important;
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
}

/* Responsive modal sizes */
@media (min-width: 576px) {
    .modal-dialog {
        max-width: 500px !important;
        margin: 1.75rem auto !important;
    }
    
    .modal-dialog-scrollable {
        max-height: calc(100% - 3.5rem) !important;
    }
    
    .modal-dialog-scrollable .modal-content {
        max-height: calc(100vh - 3.5rem) !important;
    }
}

@media (min-width: 992px) {
    .modal-lg,
    .modal-xl {
        max-width: 800px !important;
    }
}

@media (min-width: 1200px) {
    .modal-xl {
        max-width: 1140px !important;
    }
}

/* Prevent any conflicting animations */
@keyframes modalFadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

.modal.show {
    animation: none !important;
    -webkit-animation: none !important;
}

/* Disable all transitions that might cause flickering */
.modal * {
    -webkit-transition: none !important;
    transition: none !important;
}

.modal.show * {
    -webkit-transition: none !important;
    transition: none !important;
}

/* Re-enable only necessary transitions */
.modal.fade {
    transition: opacity 0.15s linear !important;
}

.modal.fade .modal-dialog {
    transition: transform 0.3s ease-out !important;
}

.modal-backdrop.fade {
    transition: opacity 0.15s linear !important;
}



